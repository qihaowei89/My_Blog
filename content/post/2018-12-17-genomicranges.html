---
title: GenomicRanges
author: RStudio
date: '2018-12-17'
slug: genomicranges
categories:
  - R
tags:
  - bioinfomatics
css: []
description: ''
highlight: yes
scripts: []
---



<p><strong>基因组集合操作<code>union</code>,<code>intersect</code>,<code>setdiff</code></strong></p>
<p><strong>1. <code>union</code>取两个基因组区域的并集</strong></p>
<pre><code>x &lt;- GRanges(&quot;chr1&quot;, IRanges(c(2, 9) , c(7, 19)), strand=c(&quot;+&quot;, &quot;-&quot;))
y &lt;- GRanges(&quot;chr1&quot;, IRanges(5, 10), strand=&quot;-&quot;) 
union(x, y)
union(x, y, ignore.strand=TRUE)</code></pre>
<p><strong>2. <code>intersect</code>取两个基因组区域的交集</strong></p>
<pre><code>intersect(x, y)
intersect(x, y, ignore.strand=TRUE)</code></pre>
<p><strong>3. <code>setdiff</code>取两个基因组区域中不同区域</strong></p>
<pre><code>setdiff(x, y)
setdiff(x, y, ignore.strand=TRUE)
</code></pre>
<p><strong>4.<code>GRangesList</code>对象同样适用</strong></p>
<pre><code>gr1 &lt;- GRanges(seqnames=&quot;chr2&quot;,
               ranges=IRanges(3, 6))
gr2 &lt;- GRanges(seqnames=c(&quot;chr1&quot;, &quot;chr1&quot;),
               ranges=IRanges(c(7,13), width = 3),
               strand=c(&quot;+&quot;, &quot;-&quot;))
gr3 &lt;- GRanges(seqnames=c(&quot;chr1&quot;, &quot;chr2&quot;),
               ranges=IRanges(c(1, 4), c(3, 9)),
               strand=c(&quot;-&quot;, &quot;-&quot;))
grlist &lt;- GRangesList(gr1=gr1, gr2=gr2, gr3=gr3)

union(grlist, shift(grlist, 3))
intersect(grlist, shift(grlist, 3))
setdiff(grlist, shift(grlist, 3))
</code></pre>
